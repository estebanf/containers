<?xml version="1.0" encoding="UTF-8"?>
<bpel:process xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:vprop="http://docs.oasis-open.org/wsbpel/2.0/varprop" xmlns:pnlk="http://docs.oasis-open.org/wsbpel/2.0/plnktype" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ode="http://www.apache.org/ode/type/extension" xmlns:ProcessimplicitPartner="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers/ProcessimplicitPartner" xmlns:ns="http://tempo.intalio.org/security/OrganizationInfoService" xmlns:tns="http://tempo.intalio.org/security/tokenService/" xmlns:Business="http://budgeting.example.everteam.com/Types/Business" xmlns:this="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers/Process" xmlns:diag="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers" xmlns:Caller="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers/Caller" xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:bpmn="http://www.intalio.com/bpms" xmlns:atomic="http://ode.apache.org/atomicScope" queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath2.0" expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath2.0" bpmn:label="Process" name="Process" bpmn:id="_XQvmgJ3EEeWJ3uz02rWKzQ" targetNamespace="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers/Process">
  <bpel:import namespace="http://tempo.intalio.org/security/OrganizationInfoService" location="../../Services/SOAP/OrganizationInfoService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
  <bpel:import namespace="http://tempo.intalio.org/security/tokenService/" location="../../Services/SOAP/TokenService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
  <bpel:import namespace="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers" location="GetTeamMembers.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
  <bpel:import namespace="http://budgeting.example.everteam.com/Processes/Integrations/GetTeamMembers/Process" location="GetTeamMembers-Process.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
  <bpel:partnerLinks>
    <bpel:partnerLink name="callerAndProcessPlkVar" partnerLinkType="diag:CallerAndProcess" myRole="Process_for_Caller"/>
    <bpel:partnerLink name="processimplicitPartnerAndProcessForPortServicePlkVar" partnerLinkType="diag:ProcessimplicitPartnerAndProcessForPortServicePlk" initializePartnerRole="yes" partnerRole="ProcessimplicitPartner_for_Process"/>
    <bpel:partnerLink name="processimplicitPartnerAndProcessForPortOrganizationInfoServiceHttpsSoapEndpointPlkVar" partnerLinkType="diag:ProcessimplicitPartnerAndProcessForPortOrganizationInfoServiceHttpsSoapEndpointPlk" initializePartnerRole="yes" partnerRole="ProcessimplicitPartner_for_Process"/>
  </bpel:partnerLinks>
  <bpel:variables>
    <bpel:variable name="thisRecieve_requestRequest1Msg" messageType="this:Recieve_requestRequest"/>
    <bpel:variable name="tnsAuthenticateUserResponse1Msg" messageType="tns:authenticateUserResponse"/>
    <bpel:variable name="tnsAuthenticateUserRequest1Msg" messageType="tns:authenticateUser"/>
    <bpel:variable name="nsGetSubordinatesResponse1Msg" messageType="ns:getSubordinatesResponse"/>
    <bpel:variable name="nsGetSubordinatesRequest1Msg" messageType="ns:getSubordinatesRequest"/>
    <bpel:variable name="thisRecieve_requestResponse2Msg" messageType="this:Recieve_requestResponse"/>
  </bpel:variables>
  <bpel:sequence>
    <bpel:receive partnerLink="callerAndProcessPlkVar" portType="this:ForCaller" operation="Recieve_request" variable="thisRecieve_requestRequest1Msg" createInstance="yes" bpmn:label="Recieve request" name="Recieve_request" bpmn:id="_idyGsJ3EEeWJ3uz02rWKzQ"></bpel:receive>
    <bpel:assign name="init-variables-Process" bpmn:id="_idyGsJ3EEeWJ3uz02rWKzQ">
      <bpel:copy bpmn:label="$tnsAuthenticateUserRequest1Msg">
        <bpel:from>
          <bpel:literal>
<tns:authenticateUser>
  <tns:user></tns:user>
  <tns:password></tns:password>
</tns:authenticateUser></bpel:literal>
        </bpel:from>
        <bpel:to>$tnsAuthenticateUserRequest1Msg.payload</bpel:to>
      </bpel:copy>
      <bpel:copy bpmn:label="$nsGetSubordinatesRequest1Msg">
        <bpel:from>
          <bpel:literal>
<ns:getSubordinates>
  <ns:userID></ns:userID>
  <ns:authenticationToken></ns:authenticationToken>
</ns:getSubordinates></bpel:literal>
        </bpel:from>
        <bpel:to>$nsGetSubordinatesRequest1Msg.parameters</bpel:to>
      </bpel:copy>
      <bpel:copy bpmn:label="$thisRecieve_requestResponse2Msg">
        <bpel:from>
          <bpel:literal>
<this:Recieve_requestResponse>
  <Business:Member>
    <Business:DisplayName></Business:DisplayName>
    <Business:username></Business:username>
  </Business:Member>
</this:Recieve_requestResponse></bpel:literal>
        </bpel:from>
        <bpel:to>$thisRecieve_requestResponse2Msg.body</bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:assign bpmn:label="authenticateUser" name="authenticateUser" bpmn:id="_rD8ENp3EEeWJ3uz02rWKzQ">
      <bpel:copy>
        <bpel:from>"admin"</bpel:from>
        <bpel:to>$tnsAuthenticateUserRequest1Msg.payload/tns:user</bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from>"changeit"</bpel:from>
        <bpel:to>$tnsAuthenticateUserRequest1Msg.payload/tns:password</bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:invoke partnerLink="processimplicitPartnerAndProcessForPortServicePlkVar" portType="tns:TokenServicePortType" operation="authenticateUser" inputVariable="tnsAuthenticateUserRequest1Msg" outputVariable="tnsAuthenticateUserResponse1Msg" bpmn:label="authenticateUser" name="authenticateUser-1" bpmn:id="_rD8ENp3EEeWJ3uz02rWKzQ"></bpel:invoke>
    <bpel:assign bpmn:label="getSubordinates" name="getSubordinates" bpmn:id="_wEnIwZ3EEeWJ3uz02rWKzQ">
      <bpel:copy>
        <bpel:from>$thisRecieve_requestRequest1Msg.body</bpel:from>
        <bpel:to>$nsGetSubordinatesRequest1Msg.parameters/ns:userID</bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from>$tnsAuthenticateUserResponse1Msg.payload/tns:token</bpel:from>
        <bpel:to>$nsGetSubordinatesRequest1Msg.parameters/ns:authenticationToken</bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:invoke partnerLink="processimplicitPartnerAndProcessForPortOrganizationInfoServiceHttpsSoapEndpointPlkVar" portType="ns:OrganizationInfoServicePortType" operation="getSubordinates" inputVariable="nsGetSubordinatesRequest1Msg" outputVariable="nsGetSubordinatesResponse1Msg" bpmn:label="getSubordinates" name="getSubordinates-1" bpmn:id="_wEnIwZ3EEeWJ3uz02rWKzQ"></bpel:invoke>
    <bpel:assign bpmn:label="Reply" name="Reply" bpmn:id="_xBGmMJ3EEeWJ3uz02rWKzQ">
      <bpel:copy>
        <bpel:from>bpel:doXslTransform("../../XSLT/transform_team_members.xsl", $nsGetSubordinatesResponse1Msg.parameters)</bpel:from>
        <bpel:to>$thisRecieve_requestResponse2Msg.body</bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:reply partnerLink="callerAndProcessPlkVar" portType="this:ForCaller" operation="Recieve_request" variable="thisRecieve_requestResponse2Msg" bpmn:label="Reply" name="Reply-1" bpmn:id="_xBGmMJ3EEeWJ3uz02rWKzQ"></bpel:reply>
  </bpel:sequence>
</bpel:process>